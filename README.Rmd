rjsonapi
========

```{r echo=FALSE}
knitr::opts_chunk$set(
  warning = FALSE,
  message = FALSE,
  collapse = TRUE,
  comment = "#>"
)
```

[![Build Status](https://travis-ci.org/sckott/rjsonapi.svg?branch=master)](https://travis-ci.org/sckott/rjsonapi)
[![codecov.io](https://codecov.io/github/sckott/rjsonapi/coverage.svg?branch=master)](https://codecov.io/github/sckott/rjsonapi?branch=master)

An R client for consuming APIs that follow the [JSONAPI spec][spec]. This library
does not do server side JSONAPI things.

* rjsonapi home: [http://jsonapi.org/](http://jsonapi.org/)
* rjsonapi spec: [http://jsonapi.org/format/](http://jsonapi.org/format/)

## Setup a JSONAPI

* `git clone git@github.com:endpoints/endpoints-example.git` (or via `hub`: `hub clone endpoints/endpoints-example`)
* `cd endpoints-example`
* `npm install`
* `PORT=8088 npm start` (start with port 8088 instead of 8080, can use a different port)

Which should start up a server. Then point your browser to e.g.:

* http://localhost:8088/v1
* http://localhost:8088/v1/authors
* http://localhost:8088/v1/authors/1

## Install rjsonapi R client

Stabler version

```{r eval=FALSE}
install.packages("rjsonapi")
```

Dev version

```{r eval=FALSE}
devtools::install_github("sckott/rjsonapi")
```

```{r}
library("rjsonapi")
```

## Connect

```{r}
(conn <- connect("http://localhost:8088/v1"))
```

## Get API info

Get version

```{r}
conn$version
```

Get base URL

```{r}
conn$base_url()
```

Get server status

```{r}
conn$status()
```

Get routes (not available in a standard JSONAPI i think)

```{r}
conn$routes()
```

## Call a route

books route

```{r}
conn$route("authors")
```

## Get a single document

First authors document

```{r}
conn$route("authors/1")
```

Sub-part under that document: `books`

```{r}
conn$route("authors/1/books")
```

A different sub-part under that document: `photos`

```{r}
conn$route("authors/1/photos")
```

## Experimental - startup a server from R

In one R session: 

```{r eval=FALSE}
jsonapi_server()
#> Starting server to listen on port 8000
```

Then in another R session:

```{r}
library("jsonlite")
jsonlite::fromJSON("http://localhost:8000/books")
```

```{r}
jsonlite::fromJSON("http://localhost:8000/books/1")
```

```{r}
jsonlite::fromJSON("http://localhost:8000/books/2")
```

Note: This server stuff is still in infancy. Working on getting a more complete set 
of routes and data.

[spec]: http://jsonapi.org/format/
